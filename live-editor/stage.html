<!DOCTYPE html>

<html>
  <head>
    <title>Riot live editor</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="style.css">
  </head>

  <body>
    <sample></sample>
    <!-- scripts we need -->
    <script src="https://cdn.jsdelivr.net/npm/riot@next/riot+compiler.min.js"></script>
    <script>
      // evaluates a compiled tag within the global context
      function globalEval(js, url) {
        const node = document.createElement('script')
        const root = document.documentElement

        // make the source available in the "(no domain)" tab
        // of Chrome DevTools, with a .js extension
        node.text =  `${js}\n//# sourceURL=${url}.js`

        root.appendChild(node)
        root.removeChild(node)
      }

      window.addEventListener('message', function(e) {
        const code = `window.Sample = ${riot.compileFromString(e.data).code}`
        globalEval(code, './sample.riot')
        riot.component(Sample)(document.querySelector('sample'))
      }, false)
    </script>
  </body>

</html>
